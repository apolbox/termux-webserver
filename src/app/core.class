#!/usr/bin/env bash
# Mengenali target operating system untuk menginstall lampp webserver
#
# @author Ayus Irfang Filaras <ayus.sahabat@gmail.com>
# @since version v1.0.0
# @license MIT
# @link https://github.com/apolbox/lampp
app.installTo()
{
  local os=${1}
  # Jika Operating system yang digunakan adalah GNU/Linux
  # jalankan instalasi webserver untuk linux.
  case ${os} in
      'GNU/Linux' ) linux.webserver;;
      'Android'   ) android.webserver;;
  esac
  
  [[ -d $HOME/storage ]] || {
    $(termux-setup-storage)
  }
  
  [[ -d $HOME/tmp ]] || {
    $(mkdir $HOME/tmp)
  }
}

app.progress()
{
    echo -ne "\n\e[33m${1}\e[0m ";

    timeout=0;

    echo -ne "\e[34m";

    while [ $timeout -lt ${2} ]
    do
        timeout=`expr $timeout + 1`
        echo -ne "${timeout}" | sed 's/[0-9]/./g';
        sleep 1
    done

    echo -ne "\e[0m\n\n";
}

app.requirementPackage()
{
  requirement=$1

  for index in ${!requirement[@]}
  do
    app.requirementInstalled ${requirement[$index]}

    [ $? -eq 0 ] || {
      printf "\n[+] Paket \e[31m[%s]\e[0m belum terinstall, Apakah Anda ingin menginstall? " "${requirement[$index]}"
      read -p "[Y/N] (Tekan enter untuk batal) " jawaban

      case ${jawaban} in
        "Y"|"y")
          sudo apt install ${requirement[$index]} -y
          ;;

        "N"|"n")
          echo -ne "\n"
          continue
          ;;

        *)
          echo -ne "\n" | exit
          ;;
      esac
    }
  done
}

app.android.requirementPackage()
{
  requirement=${1}

  for index in ${!requirement[@]}
  do
    app.requirementInstalled ${requirement[$index]}
    
    [ $? -eq 0 ] || {
      printf "\n[+] Paket \e[31m[%s]\e[0m belum terinstall, Apakah Anda ingin menginstall? " "${requirement[$index]}"
      read -p "[Y/N] (Tekan enter untuk batal) " jawaban

      case ${jawaban} in
        "Y"|"y")
          apt install ${requirement[$index]} -y
          ;;

        "N"|"n")
          echo -ne "\n"
          continue
          ;;

        *)
          echo -ne "\n" | exit 1
          ;;
      esac
    }
  done
}

app.requirementInstalled()
{
  dpkg -s $1 &> /dev/null
}
